---
title: Tuckeråˆ†è§£
math: true
fancybox: true
date: 2025-07-17
categories:
- [æ·±åº¦å­¦ä¹ ,å·¥å…·]
tags: 
- çŸ©é˜µå˜æ¢
---

Tuckeråˆ†è§£

<!-- more -->

# Tuckeråˆ†è§£

------

## ä»€ä¹ˆæ˜¯ Tucker åˆ†è§£ï¼Ÿ

Tucker åˆ†è§£æ˜¯ **å¼ é‡ï¼ˆtensorï¼‰åˆ†è§£** çš„ä¸€ç§ï¼Œæ˜¯çŸ©é˜µ SVDï¼ˆå¥‡å¼‚å€¼åˆ†è§£ï¼‰åœ¨æ›´é«˜é˜¶ä¸Šçš„æ¨å¹¿ã€‚

å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

> ç”¨ä¸€ä¸ªå°çš„ **æ ¸å¿ƒå¼ é‡** G\mathcal{G}ï¼Œä»¥åŠå‡ ä¸ªçŸ©é˜µå°†ä¸€ä¸ªå¤§çš„åŸå§‹å¼ é‡è¡¨ç¤ºå‡ºæ¥ï¼Œè¾¾åˆ°**é™ç»´ã€å‹ç¼©ã€è§£è€¦**çš„æ•ˆæœã€‚

------

## å¼ é‡ä¸æ¨¡å¼ä¹˜ç§¯ï¼ˆmode-n productï¼‰

- **çŸ©é˜µæ˜¯äºŒç»´å¼ é‡**ï¼Œä¾‹å¦‚ï¼š$A \in \mathbb{R}^{m \times n}$
- **å¼ é‡æ˜¯æ›´é«˜ç»´çš„æ•°ç»„**ï¼Œä¾‹å¦‚ï¼š
  - ä¸‰é˜¶å¼ é‡ $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$

### æ¨¡å¼-nä¹˜ç§¯ï¼ˆMode-n productï¼‰

ç»™å®šä¸‰é˜¶å¼ é‡ $\mathcal{X} \in \mathbb{R}^{I \times J \times K}$ï¼Œå’ŒçŸ©é˜µ $U \in \mathbb{R}^{L \times I}$ï¼Œé‚£ä¹ˆï¼š

$$\mathcal{Y} = \mathcal{X} \times_1 U \in \mathbb{R}^{L \times J \times K}$$

è¿™è¡¨ç¤ºå¯¹ç¬¬ä¸€ä¸ªç»´åº¦ï¼ˆmode-1ï¼‰åšçŸ©é˜µå˜æ¢ã€‚å…¶æœ¬è´¨æ˜¯ï¼š

> æŠŠå¼ é‡çš„ç¬¬1ä¸ªç»´åº¦çš„æ¯ä¸ªâ€œåˆ‡ç‰‡â€ä¹˜ä»¥ U

------

## Tucker åˆ†è§£çš„æ•°å­¦å®šä¹‰

è®¾æœ‰ä¸€ä¸ªä¸‰é˜¶å¼ é‡ï¼š

$$\mathcal{X} \in \mathbb{R}^{I \times J \times K}$$

Tucker åˆ†è§£å°†å…¶è¡¨ç¤ºä¸ºï¼š

$$\mathcal{X} \approx \mathcal{G} \times_1 A \times_2 B \times_3 C$$

å…¶ä¸­ï¼š

- $\mathcal{G} \in \mathbb{R}^{R_1 \times R_2 \times R_3}$ï¼šæ ¸å¿ƒå¼ é‡ï¼ˆå‹ç¼©è¡¨ç¤ºï¼‰
- $A \in \mathbb{R}^{I \times R_1}$ã€$B \in \mathbb{R}^{J \times R_2}$ã€$C \in \mathbb{R}^{K \times R_3}$ï¼šæ¨¡å¼çŸ©é˜µï¼Œæ§åˆ¶æ¯ä¸ªç»´åº¦çš„æŠ•å½±
- $\times_n$ï¼šè¡¨ç¤ºå¯¹å¼ é‡çš„ç¬¬ n ç»´è¿›è¡ŒçŸ©é˜µä¹˜æ³•

> æ€»ç»“ä¸€å¥è¯ï¼šTucker åˆ†è§£å°±æ˜¯ï¼š
>
> **â€œæŠŠé«˜ç»´å¼ é‡å‹ç¼©æˆå°çš„æ ¸å¿ƒå¼ é‡ + æ¯ä¸€ç»´çš„çº¿æ€§å˜æ¢çŸ©é˜µâ€**

------

## å›¾ç¤ºç†è§£ï¼ˆç¤ºæ„å›¾ï¼‰

```
            Tucker Decomposition
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  Tensor X     â”‚         åŸå§‹å¼ é‡ X âˆˆ â„^{IÃ—JÃ—K}
           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“ Tuckeråˆ†è§£
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“        â†“        â†“
  Matrix A   Matrix B   Matrix C    æ¨¡å¼çŸ©é˜µï¼ˆæ¯ä¸€ç»´çš„é™ç»´ï¼‰
   (IÃ—R1)     (JÃ—R2)     (KÃ—R3)
       â†“        â†“        â†“
            Core tensor G           æ ¸å¿ƒå¼ é‡ âˆˆ â„^{R1Ã—R2Ã—R3}
```

------

## ä¸ºä»€ä¹ˆ Tucker æœ‰ç”¨ï¼Ÿ

Tucker åˆ†è§£å¯ä»¥ï¼š

1. **é™ä½ç»´åº¦/å‹ç¼©å¼ é‡**ï¼šåŸå§‹å¼ é‡å‚æ•°é‡ä¸º $I \times J \times K$ï¼Œè€Œ Tucker åˆ†è§£åæ˜¯ï¼š

   $$I \cdot R_1 + J \cdot R_2 + K \cdot R_3 + R_1 \cdot R_2 \cdot R_3$$

   é€šå¸¸è¿œå°äºåŸå§‹å¼ é‡ã€‚

2. **æ•æ‰æ¨¡æ€ä¹‹é—´çš„äº¤äº’å…³ç³»**ï¼šæ ¸å¿ƒå¼ é‡ $\mathcal{G} $å»ºæ¨¡äº†å‹ç¼©åè¡¨ç¤ºä¹‹é—´çš„é«˜é˜¶äº¤äº’ã€‚

3. **åœ¨å¤šæ¨¡æ€åœºæ™¯ä¸­ç”¨äºèåˆ**ï¼šæ¯”å¦‚å›¾åƒã€æ–‡æœ¬è¾“å…¥ï¼Œåˆ†åˆ«ç¼–ç åé€å…¥ Tucker èåˆæ¨¡å—ã€‚

------

## ä¸¾ä¸ªæ•°å€¼ä¾‹å­

è®¾æœ‰å¼ é‡ $\mathcal{X} \in \mathbb{R}^{4 \times 3 \times 2}$ï¼Œæˆ‘ä»¬ç”¨ Tucker åˆ†è§£å®ƒï¼š

- æ¨¡å¼çŸ©é˜µï¼š
  - $A \in \mathbb{R}^{4 \times 2}$
  - $B \in \mathbb{R}^{3 \times 2}$
  - $C \in \mathbb{R}^{2 \times 1}$
- æ ¸å¿ƒå¼ é‡ $\mathcal{G} \in \mathbb{R}^{2 \times 2 \times 1}$

åˆæˆçš„å¼ é‡ä¸ºï¼š

$$\mathcal{X} \approx \mathcal{G} \times_1 A \times_2 B \times_3 C \in \mathbb{R}^{4 \times 3 \times 2}$$

------

## ä¸å…¶ä»–åˆ†è§£çš„å¯¹æ¯”

| æ–¹æ³•                   | ç±»å‹           | é€‚ç”¨åœºæ™¯              | ç‰¹ç‚¹               |
| ---------------------- | -------------- | --------------------- | ------------------ |
| Tucker                 | å¤šæ¨¡æ€å¼ é‡åˆ†è§£ | å¤šæ¨¡æ€èåˆ            | ä¿ç•™äº¤äº’ï¼Œå‚æ•°å¯æ§ |
| CP (CANDECOMP/PARAFAC) | å¼ é‡ç§©åˆ†è§£     | åˆ†è§£å¼ é‡ä¸ºç§©1åˆ†é‡ä¹‹å’Œ | æ›´ç®€å•ä½†å¯è§£é‡Šæ€§ä½ |
| PCA                    | çŸ©é˜µåˆ†è§£       | é™ç»´                  | ç›¸å½“äº SVD çš„ç‰¹ä¾‹  |
| SVD                    | çŸ©é˜µåˆ†è§£       | ç‰¹å¾æå–              | äºŒé˜¶å¼ é‡ç‰¹ä¾‹       |

------

## å®é™…åº”ç”¨

### 1. å¤šæ¨¡æ€èåˆ

å¦‚åœ¨è§†è§‰é—®ç­”ä¸­ï¼Œå°†å›¾åƒå‘é‡ vv å’Œæ–‡æœ¬å‘é‡ qq èåˆï¼Œç”¨ Tucker åˆ†è§£å®ç°æœ‰æ•ˆçš„é«˜é˜¶äº¤äº’å»ºæ¨¡ã€‚

### 2. æ¨¡å‹å‹ç¼©

å¯ä»¥ç”¨ Tucker åˆ†è§£å¯¹ CNN å·ç§¯æ ¸æˆ– Transformer æƒé‡å¼ é‡è¿›è¡Œå‹ç¼©ã€‚

### 3. å¤šä»»åŠ¡å­¦ä¹ 

å¯ä»¥ç”¨å…±äº«æ ¸å¿ƒå¼ é‡ï¼ŒåŒæ—¶ç”¨ä¸åŒæ¨¡å¼çŸ©é˜µé€‚é…ä¸åŒä»»åŠ¡ã€‚

------

## ğŸ§‘â€ğŸ”¬ Tucker åˆ†è§£çš„ PyTorch ç®€å•å®ç°

```python
# ç®€åŒ–ç‰ˆ Tucker èåˆï¼ˆv: image, q: textï¼‰
v_proj = U_v(v)      # [B, r1]
q_proj = U_q(q)      # [B, r2]
outer = torch.einsum("bi,bj->bij", v_proj, q_proj)   # [B, r1, r2]
fused = torch.einsum("bij,ijk->bk", outer, core)     # [B, r3]
out = U_o(fused)     # [B, d_out]
```

------



